<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='styles.css' rel='stylesheet' type='text/css'>
    <link href="lightbox2-master/dist/css/lightbox.min.css" rel="stylesheet">
    <style>
        #gallery img {
            margin: 4px;
        }
        #gallery a {
            border-bottom: none;
        }
    </style>
    <link href='http://fonts.googleapis.com/css?family=Lato:100,300|Parisienne' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="lightbox2-master/dist/js/lightbox.min.js"></script>
    <script type="text/javascript">
        
        lightbox.option({
            resizeDuration: 100,
            positionFromTop: 20,
            resizeDuration: 200
        });
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        $(function () {
            var filter = getParameterByName("category");
            var width = window.innerWidth;
            var halfWidth = (width - 50) / 2;
            halfWidth = Math.floor(halfWidth / 10) * 10; // round to nearest 10px
            var lightboxPadding = 27;
            var targetWidth = width > 1200 ? 1200 : Math.floor(width / 10) * 10;
            var transformWidth = targetWidth - lightboxPadding
            $.getJSON("https://young-reaches-41764.herokuapp.com/photo?category=" + filter, function(result){
            //$.getJSON("http://localhost:5000/photo?category=" + filter, function(result){

                urls = result.map(function(item){
                    var publicId = item.public_id;
                    var smaller = "https://res.cloudinary.com/dmpxnbkdx/image/upload/c_pad,w_" + halfWidth + "/" + publicId;
                    var fullSize = "https://res.cloudinary.com/dmpxnbkdx/image/upload/c_pad,w_" + transformWidth + "/" + publicId;

                    return {
                        smaller: smaller,
                        fullSize: fullSize
                    }
                });

                allHtml = urls.map(function(item){
                    return "<a href=\"" + item.fullSize + "\" data-lightbox=\"roadtrip\"><img src=\"" + item.smaller + "\"/></a>"
                });

                $("#gallery").html(allHtml);
            });
        });
    </script>
</head>

<body style="padding:0; margin-top: 0.5em;">
    <a class="little-link left" href="gallery.html">&lt; Back</a>
    <h1 class="heading">Pics!</h1>
    <div id="gallery"></div>
</body>

</html>